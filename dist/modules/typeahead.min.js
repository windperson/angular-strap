/**
 * angular-strap
 * @version v2.0.3 - 2014-06-18
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.typeahead",["mgcrea.ngStrap.tooltip","mgcrea.ngStrap.helpers.parseOptions"]).provider("$typeahead",function(){var e=this.defaults={animation:"am-fade",prefixClass:"typeahead",placement:"bottom-left",template:"typeahead/typeahead.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,minLength:1,filter:"filter",limit:6,typeaheadCircularSelect:!1};this.$get=["$window","$rootScope","$tooltip","$timeout",function(t,n,a,i){function o(t,n,o){var c={},l=t[0],r=angular.extend({},e,o);c=a(t,r);var $=o.scope,d=c.$scope;d.$resetMatches=function(){d.$matches=[],d.$activeIndex=0},d.$resetMatches(),d.$activate=function(e){i(function(){c.activate(e)},0,!1)},d.$select=function(e){i(function(){c.select(e,l)},0,!1)},d.$isActive=function(e){return e===d.$activeIndex},d.$isVisible=function(){return c.$isVisible()},c.update=function(e){d.$matches=e,d.$activeIndex>=e.length&&(d.$activeIndex=0)},c.activate=function(e){d.$activeIndex=e,d.$digest()},c.select=function(e,t){var a=d.$matches[e].value;n.$setViewValue(a),n.$render(),d.$resetMatches(),$&&$.$digest(),d.$emit("$typeahead.select",t,a,e)},c.$isVisible=function(){return r.minLength&&n?d.$matches.length&&angular.isString(n.$viewValue)&&n.$viewValue.length>=r.minLength:!!d.$matches.length},c.$getIndex=function(e){var t=d.$matches.length,n=t;if(t){for(n=t;n--&&d.$matches[n].value!==e;);if(!(0>n))return n}},c.$onMouseDown=function(e){e.preventDefault(),e.stopPropagation()},c.$onKeyDown=r.typeaheadCircularSelect?function(e){/(38|40|13)/.test(e.keyCode)&&(e.preventDefault(),e.stopPropagation(),13===e.keyCode&&d.$matches.length?d.$matches[d.$activeIndex]?c.select(d.$activeIndex,l):c.hide():38===e.keyCode?d.$activeIndex>0?d.$activeIndex--:d.$activeIndex=-1===d.$activeIndex?d.$matches.length-1:-1:40===e.keyCode?d.$activeIndex<d.$matches.length-1?d.$activeIndex++:d.$activeIndex=-1===d.$activeIndex?0:-1:angular.isUndefined(d.$activeIndex)&&(d.$activeIndex=0),d.$digest())}:function(e){/(38|40|13)/.test(e.keyCode)&&(e.preventDefault(),e.stopPropagation(),13===e.keyCode&&d.$matches.length?c.select(d.$activeIndex,l):38===e.keyCode&&d.$activeIndex>0?d.$activeIndex--:40===e.keyCode&&d.$activeIndex<d.$matches.length-1?d.$activeIndex++:angular.isUndefined(d.$activeIndex)&&(d.$activeIndex=0),d.$digest())};var s=c.show;c.show=function(){s(),setTimeout(function(){c.$element.on("mousedown",c.$onMouseDown),r.keyboard&&t.on("keydown",c.$onKeyDown)})};var u=c.hide;return c.hide=function(){c.$element.off("mousedown",c.$onMouseDown),r.keyboard&&t.off("keydown",c.$onKeyDown),u()},c.$onFocusKeyUp=function(e){27===e.which&&c.$isShown?c.hide():27===e.which||13===e.which||c.$isShown||c.show()},c}angular.element(t.document.body);return o.defaults=e,o}]}).directive("bsTypeahead",["$window","$parse","$q","$typeahead","$parseOptions",function(e,t,n,a,i){var o=a.defaults;return{restrict:"EAC",require:"ngModel",link:function(e,t,n,c){var l={scope:e};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","filter","limit","minLength","typeaheadCircularSelect"],function(e){angular.isDefined(n[e])&&(l[e]=n[e])});var r=l.filter||o.filter,$=l.limit||o.limit,d=n.ngOptions;r&&(d+=" | "+r+":$viewValue"),$&&(d+=" | limitTo:"+$);var s=i(d),u=a(t,c,l);e.$watch(n.ngModel,function(t){e.$modelValue=t,s.valuesFn(e,c).then(function(e){e.length>$&&(e=e.slice(0,$)),(1!==e.length||e[0].value!==t)&&(u.update(e),c.$render())})}),c.$render=function(){if(c.$isEmpty(c.$viewValue))return t.val("");var e=u.$getIndex(c.$modelValue),n=angular.isDefined(e)?u.$scope.$matches[e].label:c.$viewValue;n=angular.isObject(n)?n.label:n,t.val(n.replace(/<(?:.|\n)*?>/gm,"").trim())},e.$on("$destroy",function(){u.destroy(),l=null,u=null})}}}]);
//# sourceMappingURL=true